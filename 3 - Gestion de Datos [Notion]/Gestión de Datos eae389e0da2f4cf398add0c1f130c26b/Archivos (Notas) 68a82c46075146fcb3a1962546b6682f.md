# Archivos (Notas)

- Las BDD se almacenan físicamente como archivos en algún medio de almacenamiento.
- El SGBD puede recuperar, actualizar y procesar estos datos cuando lo necesite.
- Archivos forman parte del esquema **físico** de la base de datos.
- Los datos se almacenan en forma de registros, registros se almacenan en archivos. En general, todos los registros de un archivo son del mismo tamaño.
    - Regs. de long fija: Todos los regs tienen en el mismo tamaño en bytes. R es el tamaño de cada registro, r es la cantidad de registros del archivo.
    - Regs de long variable: Los registros tienen tamaños diferentes.
- Organización de los registros en los bloques. Tamaño de bloques: B. Cant. de bloques en archivo: b.
    - Org. extendida: Puede almacenar parte de un registro en un bloque y el resto en otro. Sea el bloque continuo o no (si no es contiguo, se debe usar espacio para almacenar un puntero al siguiente bloque).
    - Org. no extendida: No se permite que un registro este almacenado en muchos bloques.
- Siempre se trata que B > R.
- Factor de bloqueo (fbi): Cantidad de registros en un bloque. $fbi=\lfloor B/R \rfloor$
- Cantidad de bloques para almacenar un archivo de $r$ registros. $b = \lceil r/fbi \rceil$  (Notar que se sobreestima).
- El disco puede implementar asignación fija o continua (Ver [File System - pt. II](https://www.notion.so/File-System-pt-II-1179f3621e21456bae10c832a7f48a84?pvs=21)).
- En archivos de registros desordenados: La reogranización periodica es necesaria porque solo se insertan nuevos registros al final. No se tiene una estructura auxiliar para saber que registros estan activos y cuales no.
- Hash:
    - No termina siendo literalmente dirección del bloque de disco, sino que la posición relativa en el conjunto de cubetas. Aun así, los registros no se guardan *literalmente* en la cubeta.
    - La cubeta es una estrucutra logica. La cabecera del archivo tiene información sobre que dirección de bloque de disco corresponde a cada cubeta.
    - Si en encadenamiento se borra un registro que NO es el ultimo de la cadena de registros con el mismo hash, lo que se hace es reemplazarlo por el ultimo y se mantiene la secuencia.
- Solo es posible tener un indice primario por archivo. Esto es porque el archivo esta ordenado por un solo campo (el de ordenamiento) y el indice se basa en él.
- En la catedra se consideran punteros a bloques, porque la realidad es que lo que se termina trayendo a memoria es un bloque de disco