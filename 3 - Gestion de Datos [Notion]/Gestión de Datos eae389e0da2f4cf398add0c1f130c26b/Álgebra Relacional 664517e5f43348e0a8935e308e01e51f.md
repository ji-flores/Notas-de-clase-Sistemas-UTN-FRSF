# Álgebra Relacional

- P1. El algebra relacional es un lenguaje procedural, a diferencia de SQL que es un lenguaje declarativo.

# Operaciones unarias

## Selección ($\sigma$)

Selecciona tuplas de una relación R que satisfacen un predicado dado.

- Actua como filtro.
- Se seleccionan las tuplas que satisfacen la condición, mientras que las otras tuplas se descartan.
- Genera una relación de igual grado (cant. de columnas) que R.
- Genera una partición horizontal

**Sintaxis: $\sigma_{<cond>}(R)$**

### Propiedades

Conmutatividad:

$$
\sigma_{cond1}(\sigma_{cond2}(R)) = \sigma_{cond2}(\sigma_{cond1}(R)) 
$$

Se puede combinar una cascada en una sola condición con ANDs

$$
\sigma_{cond1}(\sigma_{cond2}(R)) = \sigma_{cond1\:AND\:cond2}(R)
$$

## Proyección ($\pi$)

- Devuelve ciertas columnas (atributos) de una relación y descarta las otras columnas.
- Elimina las tuplas duplicadas.
- Genera una partición vertical.

Sintaxis: $\pi_{<listaDeAtributos>}(R)$

- **Lista de atributos:** Es la lista deseada de atributos de la relacion R a incluir en la relación resultado
- La nueva relación que se obtiene como resultados contiene solo los atributos de R especificados en la lista de atributos **y en el orden en el que fueron listados** en la Lista de atributos.

## Escribiendo operaciones

Puede escribirse una unica expresion de algebra relacional:

$\pi_{Nombre,Apellido1,Apellido2,Sueldo} (\sigma_{DNO=5}(Empleado))$

O puede usarse un operador de definición ($\leftarrow$), mostrar explícitamente la secuencia de operaciones

(…)

## Renombrar ($\rho$)

Permite cambiar el nombre de los atributos de una relación, o el nombre de la relación, o ambos.

Sintaxis:

- Renombrar relación: $\rho_S(R)$
- Renombrar atributos: $\rho_{(a1,...,aN)}(R)$
- Renombrar ambos: $\rho_{S(a1,...,aN)}(R)$

# Operaciones de conjunto

1. **Unión**
2. **Intersección**
3. **Diferencia**
4. **Producto cartesiano**

Para las operaciones 1, 2 y 3, las tablas deben ser compatibles con la unión o de unión compatible. Para ello deben cumplir:

- Las relaciones deben tener el mismo orden (cant. de atributos o columnas).
- Los atributos deben estar en el mismo orden.
- Los dominios de los atributos deben ser los mismos.

## Unión

**Sintaxis:** $R \cup S$

- El resultado es la relación que contiene todas las tuplas que estén en R o en S.
- Como en un conjunto, elimina duplicados.
- Por convención, el nombre de la relación resultado es el mismo que el del primer operando.

## Intersección

**Sintaxis**: $R \cap S$

- El resultado es la relación que incluye todas las tuplas que están en R y S.

## Diferencia

**Sintaxis:** $R -S$

- El resultado es la relación que incluye todas las tuplas que están en R pero no en S.

## Propiedades

- Union e Intersección son conmutativas.
- Diferencia no conmutativa.
- La union e intersección son asociativas entre si.

## Producto Cartesiano

- Sintaxis: $R \times S$
- Combina cada una de las tuplas de una relación R con todas las tuplas de otra relación S
- Para una relacion $R(R_0,…,R_n)$ y otra $S(S_0,…,S_m)$, el resultado será $Q(R_0,…,R_n,S_0,…,S_m)$, con grado $n+m$.
- La relación resultante $Q$ tiene una tupla por cada combinación de éstas (una para $R$ y otra para S). Por tanto, si $R$ tiene $n_R$ tuplas (indicado como $|R| = n_{R}$ ), y S cuenta con nS tuplas, $R\times S$ tendrá $n_{R} ∗ n_{S}$ tuplas.
- …

(Aca faltarian ejemplos)

## Reunion (o Join)

*A veces en vez de llamarlo Join se lo llama Inner Join, para distinguirlo del Outer Join*

**Sintaxis:** $R \bowtie_{<cond>} S$

- Como es tan comun tener un **producto cartesiano seguido de una selección** para eliminar las tuplas que no tengan sentido para la consulta, existe una operación Reunión (Join)
- Contiene las tuplas que son combinación de tuplas de dos relaciones que satisfacen una condicion de reunion sobre atributos que toman valores del mismo dominio en ambas relaciones.

Ejemplo:

$$
\text{DirectorDepto} \leftarrow \text{Departamento} \bowtie_{\text{DniDirector}= \text{Dni}}\text{Empleado}
$$

## Division

**Sintaxis:** $R \div S$

- **Resultado:** Mejor verlo con un ejemplo...

![Untitled](A%CC%81lgebra%20Relacional%20664517e5f43348e0a8935e308e01e51f/Untitled.png)

- Esta operación se establece en consultas que incluyen la frase *todas/os*, *cada una/o*.

# Operaciones adicionales

- No pueden expresarse en el algebra relacional básica.
- Son funciones matemáticas sobre colecciones: CUENTA, SUMA, PROMEDIO, MÁXIMO y MINIMO.

**Sintaxis:** $\mathcal{F}_{\text{<lista-de-funciones>}}(R)$

Donde:

- $\text{<lista-de-funciones>}$ es una lista de pares `<función_0> <atributo_0>, <funcion_1> <atributo_1>, …, <funcion_N> <atributo_N>`
- La relación resultante tiene un atributo por cada elemento de la lista de funciones.
- Los duplicados no se eliminan cuando se aplican funciones de agregación.

## MAXIMO

Ejemplo de aplicación:

$\mathcal{F}_{\text{MINIMO Sueldo}}(\text{Empleado})$

## Agrupamiento y funciones de agragación

Consiste en:

- Agrupar las tuplas en grupos en base al valor de ciertos atributos.
- Aplicar las operaciones no sobre la tabla entera, sino sobre cada uno de los grupos. Entonces, la relación resultante tendrá **una tupla por cada grupo**. La relación resultado también incluye el atributo segun el cual se agrupa, para poder reconocer que resultado corresponde a cada (conjunto de?) atrbiuto

**Sintaxis:** $_{\text{<atributo>}}\mathcal{F}_{\text{<lista\_de\_funciones>}}(R)$

$T_1 \leftarrow _{dniEmpleado}\mathcal{F}_{\text{CUENTA}\;nombEmpleado}(\text{Subordinado})$

$T_2 \leftarrow \text{Empleado} \bowtie_{dni\:=\:dniEmpleado}T_1$

$T_3 \leftarrow$

## Reunion Externa (Outer join)